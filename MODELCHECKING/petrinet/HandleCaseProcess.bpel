<!-- HandleCaseProcess BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Fri Jun 01 15:01:23 CEST 2018 -->
<bpel:process name="HandleCaseProcess"
         targetNamespace="http://bpel.casus.ou"
         suppressJoinFailure="yes"
         xmlns:tns="http://bpel.casus.ou"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ns="http://handlecase.casus.ws.ou" xmlns:ns1="http://www.w3.org/2001/XMLSchema" 
         xmlns:ns0="http://handleobjection.casus.ws.ou">

    <!-- Import the client WSDL -->
    <bpel:import namespace="http://handlecase.casus.ws.ou" location="HandleCase.wsdl" importType="http://schemas.xmlsoap.org/wsdl/" />
    <bpel:import location="HandleCaseProcessArtifacts.wsdl" namespace="http://bpel.casus.ou" 
	        importType="http://schemas.xmlsoap.org/wsdl/" />
         
    <!-- ================================================================= -->         
    <!-- PARTNERLINKS                                                      -->
    <!-- List of services participating in this BPEL process               -->
    <!-- ================================================================= -->         
    <bpel:partnerLinks>
        <!-- The 'client' role represents the requester of this service. -->
        <bpel:partnerLink name="client"
                     partnerLinkType="tns:HandleCaseProcess"
                     myRole="HandleCaseProcessProvider"
                     />
        <bpel:partnerLink name="HandleCasePL" partnerLinkType="tns:HandleCasePLT" partnerRole="HandleCasePLTRole"></bpel:partnerLink>
        
    </bpel:partnerLinks>
  
    <!-- ================================================================= -->         
    <!-- VARIABLES                                                         -->
    <!-- List of messages and XML documents used within this BPEL process  -->
    <!-- ================================================================= -->         
    <bpel:variables>
        <!-- Reference to the message passed as input during initiation -->
        <bpel:variable name="handleCaseInput"
                  messageType="tns:HandleCaseProcessReq"/>
                  
        <!-- 
          Reference to the message that will be returned to the requester
          -->
        <bpel:variable name="handleCaseOutput"
                  messageType="tns:HandleCaseProcessResp"/>
        <bpel:variable name="registerCaseReply" messageType="ns:registerCaseResponse"></bpel:variable>
        <bpel:variable name="registerCaseRequest" messageType="ns:registerCaseRequest"></bpel:variable>
        <bpel:variable name="createCaseReply" messageType="ns:createCaseResponse"></bpel:variable>
        <bpel:variable name="createCaseRequest" messageType="ns:createCaseRequest"></bpel:variable>
        
        
        
        <bpel:variable name="ticket" type="ns1:string"></bpel:variable>
        <bpel:variable name="validateCaseReply" messageType="ns:validateCaseResponse"></bpel:variable>
        <bpel:variable name="validateCaseRequest" messageType="ns:validateCaseRequest"></bpel:variable>
        <bpel:variable name="parkCaseReply" messageType="ns:parkCaseResponse"></bpel:variable>
        <bpel:variable name="parkCaseRequest" messageType="ns:parkCaseRequest"></bpel:variable>
        <bpel:variable name="stopCaseInput" messageType="tns:stopCaseReq"></bpel:variable>
        <bpel:variable name="stopCaseOutput" messageType="tns:stopCaseResp"></bpel:variable>
        <bpel:variable name="stopCaseReply" messageType="ns:stopCaseResponse"></bpel:variable>
        <bpel:variable name="stopCaseRequest" messageType="ns:stopCaseRequest"></bpel:variable>
        <bpel:variable name="exception" messageType="ns:WsException">
            <bpel:from><bpel:literal>impl:faultCode</bpel:literal></bpel:from>
        </bpel:variable>
        
        
        <bpel:variable name="handleObjectionInput" messageType="tns:handleObjectionReq"></bpel:variable>
        <bpel:variable name="handleObjectionOutput" messageType="tns:handleObjectionResp"></bpel:variable>
        <bpel:variable name="registerObjectionCaseReply" messageType="ns:registerObjectionCaseResponse"></bpel:variable>
        <bpel:variable name="registerObjectionCaseRequest" messageType="ns:registerObjectionCaseRequest"></bpel:variable>
        <bpel:variable name="createObjectionCaseReply" messageType="ns:createObjectionCaseResponse"></bpel:variable>
        <bpel:variable name="createObjectionCaseRequest" messageType="ns:createObjectionCaseRequest"></bpel:variable>
        <bpel:variable name="validateObjectionCaseReply" messageType="ns:validateObjectionCaseResponse"></bpel:variable>
        <bpel:variable name="validateObjectionCaseRequest" messageType="ns:validateObjectionCaseRequest"></bpel:variable>
        <bpel:variable name="createObjectionTaskReply" messageType="ns:createObjectionTaskResponse"></bpel:variable>
        <bpel:variable name="createObjectionTaskRequest" messageType="ns:createObjectionTaskRequest"></bpel:variable>
        <bpel:variable name="handleParkedCaseInput" messageType="tns:handleParkedCaseReq"></bpel:variable>
        <bpel:variable name="handleParkedCaseOutput" messageType="tns:handleParkedCaseResp"></bpel:variable>
        
        
        <bpel:variable name="reinjectCaseInput" messageType="tns:reinjectCaseReq"></bpel:variable>
        <bpel:variable name="reinjectCaseOutput" messageType="tns:reinjectCaseResp"></bpel:variable>
        <bpel:variable name="caseId" type="ns1:string"></bpel:variable>
        <bpel:variable name="caseType" type="ns1:string"></bpel:variable>
        <bpel:variable name="errorIndicator" type="ns1:string">
            <bpel:from>
                <bpel:literal>Ok</bpel:literal>
            </bpel:from>
        </bpel:variable>
        <bpel:variable name="caseHandlingTrigger" type="ns1:string"></bpel:variable>
        <bpel:variable name="caseExceptionPoint" type="ns1:string">
            <bpel:from>
                <bpel:literal>0</bpel:literal>
            </bpel:from>
        </bpel:variable>
        <bpel:variable name="noreinjection" type="ns1:string">
            <bpel:from>
                <bpel:literal>false</bpel:literal>
            </bpel:from>
        </bpel:variable>
        <bpel:variable name="getCalculationReply" messageType="ns:getCalculationResponse"></bpel:variable>
        <bpel:variable name="getCalculationRequest" messageType="ns:getCalculationRequest"></bpel:variable>
        
        
        
        <bpel:variable name="checkProcessabilityReply" messageType="ns:checkProcessabilityResponse"></bpel:variable>
        
        <bpel:variable name="createPaymentReply" messageType="ns:createPaymentResponse"></bpel:variable>
        <bpel:variable name="createPaymentRequest" messageType="ns:createPaymentRequest"></bpel:variable>
        <bpel:variable name="sendLetterReply" messageType="ns:sendLetterResponse"></bpel:variable>
        <bpel:variable name="sendLetterRequest" messageType="ns:sendLetterRequest"></bpel:variable>
        <bpel:variable name="endCaseReply" messageType="ns:endCaseResponse"></bpel:variable>
        <bpel:variable name="endCaseRequest" messageType="ns:endCaseRequest"></bpel:variable>
        <bpel:variable name="checkProcessabilityRequest" messageType="ns:checkProcessabilityRequest"></bpel:variable>
        <bpel:variable name="createExceptionTaskReply" messageType="ns:createExceptionTaskResponse"></bpel:variable>
        <bpel:variable name="createExceptionTaskRequest" messageType="ns:createExceptionTaskRequest"></bpel:variable>
        <bpel:variable name="valueOk" type="ns1:string">
        </bpel:variable>
    </bpel:variables>

    <!-- ================================================================= -->         
    <!-- ORCHESTRATION LOGIC                                               -->
    <!-- Set of activities coordinating the flow of messages across the    -->
    <!-- services integrated within this business process                  -->
    <!-- ================================================================= -->         
    <bpel:sequence name="CaseHandler">
        
        <!-- Receive input from requester. 
             Note: This maps to operation defined in HandleCaseProcess.wsdl 
             -->
        
        
        
        <!-- Generate reply to synchronous request -->
        
        
        
        
        <bpel:pick name="HandleRequest" createInstance="yes">
        	<bpel:onMessage partnerLink="client" operation="handleCase" portType="tns:HandleCaseProcess" variable="handleCaseInput">
                <bpel:sequence name="PrepareHandleCaseServices">
                    <bpel:assign validate="no" name="InitHandleCase">
                        <bpel:copy>
                            <bpel:from part="payload" variable="handleCaseInput"/>
                            <bpel:to variable="caseId"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="payload" variable="handleCaseInput"/>
                            <bpel:to variable="caseType"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="payload" variable="handleCaseInput" />
                            <bpel:to variable="errorIndicator"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>true</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="noreinjection"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>handleCase</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="caseHandlingTrigger"></bpel:to>
                        </bpel:copy>
                        
                    </bpel:assign>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </bpel:sequence>
            </bpel:onMessage>
            <bpel:onMessage partnerLink="client" operation="handleParkedCase" portType="tns:HandleCaseProcess" variable="handleParkedCaseInput">
                <bpel:sequence name="PrepareHandleParkedCaseServices">
                    <bpel:assign validate="no" name="InitHandleParkedCase">
                        <bpel:copy>
                            <bpel:from part="parameters" variable="handleParkedCaseInput"/>
                            <bpel:to variable="caseId"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="handleParkedCaseInput"/>
                            <bpel:to variable="caseType"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="handleParkedCaseInput"/>
                            <bpel:to variable="errorIndicator"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>true</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="noreinjection"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>handleParkedCase</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="caseHandlingTrigger"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>Ok</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="valueOk"></bpel:to>
                        </bpel:copy>
                        
                    </bpel:assign>
                    
             </bpel:sequence>
            </bpel:onMessage>
            <bpel:onMessage partnerLink="client" operation="stopCase" portType="tns:HandleCaseProcess" variable="stopCaseInput">
                <bpel:sequence name="PrepareInvokeStopCase">
                    <bpel:assign validate="no" name="InitStopCase">
                        <bpel:copy>
                            <bpel:from part="parameters" variable="stopCaseInput" />
                            <bpel:to variable="caseId"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="stopCaseInput"/>
                            <bpel:to variable="errorIndicator"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>true</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="noreinjection"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>stopCase</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="caseHandlingTrigger"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>Ok</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="valueOk"></bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    
                    
                    
                    
                    
                    
                    
                    
                    
                </bpel:sequence>
            </bpel:onMessage>
        
            
            
            
            <bpel:onMessage partnerLink="client" operation="handleObjection" portType="tns:HandleCaseProcess" variable="handleObjectionInput"><bpel:sequence name="PrepareHandleObjection">
                    
                    
                    
                    
                    
                    <bpel:assign validate="no" name="InitHandleObjection">
                        <bpel:copy>
                            <bpel:from part="parameters" variable="handleObjectionInput"/>
                            <bpel:to variable="caseId"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="handleObjectionInput"/>
                            <bpel:to variable="caseType"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="handleObjectionInput"/>
                            <bpel:to variable="errorIndicator"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>true</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="noreinjection"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>handleObjection</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="caseHandlingTrigger"></bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                     
                </bpel:sequence>
            
            </bpel:onMessage>
            <bpel:onMessage partnerLink="client" operation="reinjectCase" portType="tns:HandleCaseProcess" variable="reinjectCaseInput">
                <bpel:sequence name="PrepareReinjectCase">
                    
                    
                    <bpel:assign validate="no" name="InitReinjectCase">
                        <bpel:copy>
                            <bpel:from part="parameters" variable="reinjectCaseInput"/>
                            <bpel:to variable="caseId"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="reinjectCaseInput"/>
                            <bpel:to variable="caseType"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="reinjectCaseInput"/>
                            <bpel:to variable="caseHandlingTrigger"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="reinjectCaseInput"/>
                            <bpel:to variable="caseExceptionPoint"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from part="parameters" variable="reinjectCaseInput"/>
                            <bpel:to variable="errorIndicator"></bpel:to>
                        </bpel:copy>
                        
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>false</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="noreinjection"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from>
                                <bpel:literal>Ok</bpel:literal>
                            </bpel:from>
                            <bpel:to variable="valueOk"></bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    
                </bpel:sequence>
            </bpel:onMessage>
        </bpel:pick>
        <bpel:if name="HandleReceivedCaseRequest">
            <bpel:condition caseHandlingTrigger="handleCase"/>
            <bpel:sequence name="InvokeHandleCaseServices"><bpel:sequence name="RegisterCase">
                        <bpel:assign validate="no" name="PrepareInvokeRegisterCase">
            <bpel:copy>
                <bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                <bpel:to part="parameters" variable="registerCaseRequest"></bpel:to>
            </bpel:copy>
            
            
            <bpel:copy>
                <bpel:from variable="caseId">
                                </bpel:from>
                <bpel:to part="parameters" variable="registerCaseRequest"/>
            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="caseType">
                                </bpel:from>
                                <bpel:to part="parameters" variable="registerCaseRequest"/>
                            </bpel:copy>
                            
                            <bpel:copy>
                                <bpel:from variable="errorIndicator">
                                </bpel:from>
                                <bpel:to part="parameters" variable="registerCaseRequest"/>
                            </bpel:copy>
                        
                        
                    </bpel:assign>
                        
                        <bpel:invoke name="InvokeRegisterCase" partnerLink="HandleCasePL" operation="registerCase" portType="ns:HandleCase" inputVariable="registerCaseRequest" outputVariable="registerCaseReply">
						<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException"><bpel:sequence name="Rollback">
                                    <bpel:assign validate="no" name="PrepareRollback">
                                    
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>-1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>RegisterCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    
                                </bpel:assign>
                                    
                                    <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:RollbackTransaction"></bpel:throw>
                                    </bpel:sequence>
								</bpel:catch>
								</bpel:invoke>
                        
                        
                        <bpel:assign validate="no" name="SaveTicket">
                            <bpel:copy>
                                <bpel:from part="parameters" variable="registerCaseReply"/>
                                <bpel:to variable="ticket"></bpel:to>
                            </bpel:copy>
                        </bpel:assign>
                    </bpel:sequence>
                        <bpel:sequence name="CreateCase">
                    <bpel:assign validate="no" name="PrepareInvokeCreateCase"><bpel:copy>
                                <bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                                <bpel:to variable="createCaseRequest" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="ticket">
                                </bpel:from>
                                <bpel:to part="parameters" variable="createCaseRequest"/>
                            </bpel:copy>
                            
                        
                    </bpel:assign>
                    <bpel:invoke name="InvokeCreateCase" partnerLink="HandleCasePL" operation="createCase" portType="ns:HandleCase" inputVariable="createCaseRequest" outputVariable="createCaseReply">
                    	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from><bpel:literal>1</bpel:literal></bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from><bpel:literal>CreateCase</bpel:literal></bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest" />
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply" />
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault" />
                        </bpel:sequence>
                        </bpel:catch>
                   	</bpel:invoke>
                    
                        </bpel:sequence>
                        <bpel:sequence name="ValidateCase"><bpel:assign validate="no" name="PrepareInvokeValidateCase">
                            <bpel:copy>
                                <bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                                <bpel:to variable="validateCaseRequest" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="ticket"></bpel:from>
                                <bpel:to part="parameters" variable="validateCaseRequest"/>
                            </bpel:copy>
                        </bpel:assign>
                  	<bpel:invoke name="InvokeValidateCase" partnerLink="HandleCasePL" operation="validateCase" portType="ns:HandleCase" inputVariable="validateCaseRequest" outputVariable="validateCaseReply">
	              	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>ValidateCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
                  	</bpel:invoke>
                  	
                            <bpel:sequence name="ParkCase"><bpel:assign validate="no" name="PrepareInvokeParkCase">
                            <bpel:copy>
                                <bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                                <bpel:to variable="parkCaseRequest" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="ticket"></bpel:from>
                                <bpel:to part="parameters" variable="parkCaseRequest"/>
                            </bpel:copy>
                        </bpel:assign>
               		<bpel:invoke name="InvokeParkCase" partnerLink="HandleCasePL" operation="parkCase" portType="ns:HandleCase" inputVariable="parkCaseRequest" outputVariable="parkCaseReply">
	              	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>ParkCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply" />
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"/>
                        </bpel:sequence>
                        </bpel:catch>  
                    </bpel:invoke>
                    
                            </bpel:sequence>
                        </bpel:sequence>
                <bpel:if name="IfNotReinjectedCase">
                    <bpel:condition noreinjection="true" />
                    <bpel:sequence name="ReplyHandleCaseResponse"><bpel:assign validate="no" name="PrepareReplyHandleCase">
                                <bpel:copy>
                                    <bpel:from><bpel:literal>tns:result</bpel:literal>
                            
                                    </bpel:from><bpel:to part="payload" variable="handleCaseOutput"></bpel:to>
                        
                        
                                </bpel:copy><bpel:copy><bpel:from variable="ticket">
                </bpel:from>
                <bpel:to part="payload" variable="handleCaseOutput"/>
            
                        </bpel:copy>
                    
                            
                            </bpel:assign>
                            <bpel:reply name="ReplyHandleCase" partnerLink="client" portType="tns:HandleCaseProcess" operation="handleCase" variable="handleCaseOutput" />
                        
                        
                        
                    </bpel:sequence>
                </bpel:if>
                
                    
                
            </bpel:sequence>
            <bpel:elseif>
                <bpel:condition caseHandlingTrigger="handleParkedCase" />
                <bpel:sequence name="InvokeHandleParkedCaseServices">
                        
                    <bpel:sequence name="GetCalculation"><bpel:assign validate="no" name="PrepareInvokeGetCalculation">
                        
                        
                    
                            <bpel:copy>
                                <bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                                <bpel:to variable="getCalculationRequest" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="caseId">
                                </bpel:from>
                                <bpel:to part="parameters" variable="getCalculationRequest"/>
                            </bpel:copy>
                        </bpel:assign>
    <bpel:invoke name="InvokeGetCalculation" partnerLink="HandleCasePL" operation="getCalculation" portType="ns:HandleCase" inputVariable="getCalculationRequest" outputVariable="getCalculationReply">
	              	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>GetCalculation</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
	</bpel:invoke>

                    
                    
                    </bpel:sequence>
                    <bpel:sequence name="CheckProcessability"><bpel:assign validate="no" name="PrepareInvokeCheckProcessability">
                            
                        
                            
                            
                            
                            <bpel:copy>
                                <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="checkProcessabilityRequest"></bpel:to>
                            </bpel:copy>
                            
                        </bpel:assign>
                    
                        <bpel:invoke name="InvokeCheckProcessability" partnerLink="HandleCasePL" operation="checkProcessability" portType="ns:HandleCase" inputVariable="checkProcessabilityRequest" outputVariable="checkProcessabilityReply">
						<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>CheckProcessability</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"/>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"/>
                        </bpel:sequence>
                        </bpel:catch>  
						</bpel:invoke>
                    
                        </bpel:sequence>
                    <bpel:if name="IfDegree">
                        <bpel:condition caseType="D" />
                        <bpel:sequence name="CreatePayment"><bpel:assign validate="no" name="PrepareInvokeCreatePayment"><bpel:copy>
                                <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="createPaymentRequest"></bpel:to>
                            </bpel:copy>
                            
                        
                            </bpel:assign>
					<bpel:invoke name="InvokeCreatePayment" partnerLink="HandleCasePL" operation="createPayment" portType="ns:HandleCase" inputVariable="createPaymentRequest" outputVariable="createPaymentReply">
						<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>CreatePayment</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"/>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"/>
                        </bpel:sequence>
                        </bpel:catch>  
					</bpel:invoke>
                    
                    
                        
                        </bpel:sequence>
                    </bpel:if>
                    
                        <bpel:sequence name="SendLetter">
                            <bpel:assign validate="no" name="PrepareInvokeSendLetter"><bpel:copy>
                                <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="sendLetterRequest"></bpel:to>
                            </bpel:copy>
                            
                        
                            </bpel:assign>

                        <bpel:invoke name="InvokeSendLetter" partnerLink="HandleCasePL" operation="sendLetter" portType="ns:HandleCase" inputVariable="sendLetterRequest" outputVariable="sendLetterReply">
						<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>SendLetter</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
						</bpel:invoke>

							</bpel:sequence>
                        <bpel:sequence name="EndCase">
                            <bpel:assign validate="no" name="PrepareInvokeEndCase"><bpel:copy>
                                <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="endCaseRequest"></bpel:to>
                            </bpel:copy>
                            
                        
                            </bpel:assign>

						<bpel:invoke name="InvokeEndCase" partnerLink="HandleCasePL" operation="endCase" portType="ns:HandleCase" inputVariable="endCaseRequest" outputVariable="endCaseReply">
						<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>EndCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
						</bpel:invoke>
                    
                    
                        </bpel:sequence>
                    
                    
                    <bpel:if name="IfNotReinjectedParkedCase"><bpel:condition noreinjection="true"/>
                    
                        <bpel:sequence name="ReplyHandleParkedCaseResponse"><bpel:assign validate="no" name="PrepareReplyHandleParkedCase"><bpel:copy>
                                <bpel:from>
                                    <bpel:literal>tns:result</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="handleParkedCaseOutput"></bpel:to>
                            </bpel:copy>
                            
                            <bpel:copy>
                                <bpel:from variable="valueOk"></bpel:from>
                                <bpel:to part="parameters" variable="handleParkedCaseOutput"/>
                            </bpel:copy>
                            
                        
                            </bpel:assign><bpel:reply name="ReplyHandleParkedCase" partnerLink="client" operation="handleParkedCase" portType="tns:HandleCaseProcess" variable="handleParkedCaseOutput"></bpel:reply>
                    
                        
                        
                        </bpel:sequence>
                    </bpel:if>
                </bpel:sequence>
            </bpel:elseif><bpel:elseif>
                <bpel:condition caseHandlingTrigger="stopCase"/>
                <bpel:sequence name="InvokeStopCaseService">
                        <bpel:sequence name="StopCase">
                        <bpel:assign validate="no" name="PrepareInvokeStopCase">
                        <bpel:copy>
                            <bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                            <bpel:to variable="stopCaseRequest" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from variable="caseId">
                            </bpel:from>
                            <bpel:to part="parameters" variable="stopCaseRequest"/>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from variable="errorIndicator">
                            </bpel:from>
                            <bpel:to part="parameters" variable="stopCaseRequest"/>
                        </bpel:copy>
                    </bpel:assign>

					<bpel:invoke name="InvokeStopCase" partnerLink="HandleCasePL" operation="stopCase" portType="ns:HandleCase" inputVariable="stopCaseRequest" outputVariable="stopCaseReply">
	              	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>StopCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
					</bpel:invoke>

					</bpel:sequence>
                    <bpel:if name="IfNotReinjectedStopCase">
                        <bpel:condition noreinjection="true"/>
                        <bpel:sequence name="ReplyStopCaseResponse">
                            <bpel:assign validate="no" name="PrepareReplyStopCase"><bpel:copy>
                                <bpel:from><bpel:literal>tns:result</bpel:literal></bpel:from>
                                <bpel:to variable="stopCaseOutput" part="parameters"></bpel:to>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="valueOk"></bpel:from>
                                <bpel:to part="parameters" variable="stopCaseOutput"/>
                            </bpel:copy>
                        
                            </bpel:assign><bpel:reply name="ReplyStopCase" partnerLink="client" operation="stopCase" portType="tns:HandleCaseProcess" variable="stopCaseOutput"></bpel:reply>
                    
                        
                        </bpel:sequence>
                    </bpel:if>
                    
                    </bpel:sequence>
            </bpel:elseif><bpel:elseif>
                <bpel:condition caseHandlingTrigger="handleObjection"/>
                <bpel:sequence name="InvokeHandleObjectionServices">
                        <bpel:sequence name="HandleObjectionServices"><bpel:sequence name="RegisterObjectionCase">
                        <bpel:assign validate="no" name="PrepareRegisterObjectionCase">
                            
                                <bpel:copy>
                                    <bpel:from>
                                        <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="registerObjectionCaseRequest"></bpel:to>
                                </bpel:copy>
                                
                            
                            <bpel:copy>
                                <bpel:from variable="caseId">
                                </bpel:from>
                                <bpel:to part="parameters" variable="registerObjectionCaseRequest"/>
                            </bpel:copy>
                            <bpel:copy>
                                <bpel:from variable="caseType"></bpel:from>
                                <bpel:to part="parameters" variable="registerObjectionCaseRequest"/>
                             </bpel:copy>
                            
                        </bpel:assign>
                        <bpel:invoke name="InvokeRegisterObjectionCase" partnerLink="HandleCasePL" operation="registerObjectionCase" portType="ns:HandleCase" inputVariable="registerObjectionCaseRequest" outputVariable="registerObjectionCaseReply">
								<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException"><bpel:sequence name="Rollback">
                                    <bpel:assign validate="no" name="PrepareRollback">
                                    
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>-1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>RegisterObjectionCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    
									</bpel:assign>
                                    
                                    <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:RollbackTransaction"></bpel:throw>
                                    </bpel:sequence>
								</bpel:catch>
						
						</bpel:invoke>
                        
                        <bpel:assign validate="no" name="SaveObjectionTicket">
                            <bpel:copy>
                                <bpel:from part="parameters" variable="registerObjectionCaseReply"/>
                                <bpel:to variable="ticket"></bpel:to>
                            </bpel:copy>
                            
                        </bpel:assign>
                    </bpel:sequence>
                        <bpel:sequence name="CreateObjectionCase"><bpel:assign validate="no" name="PrepareCreateObjectionCase">
						<bpel:copy>
								<bpel:from><bpel:literal>impl:id</bpel:literal></bpel:from>
                                <bpel:to variable="createObjectionCaseRequest" part="parameters"></bpel:to>
                            
                            </bpel:copy>
                            
                        
                            
                            
                            <bpel:copy><bpel:from variable="ticket">
                                </bpel:from>
                                <bpel:to part="parameters" variable="createObjectionCaseRequest"/>
                            
                            </bpel:copy>
                            
                        </bpel:assign>
					<bpel:invoke name="InvokeCreateObjectionCase" partnerLink="HandleCasePL" operation="createObjectionCase" portType="ns:HandleCase" inputVariable="createObjectionCaseRequest" outputVariable="createObjectionCaseReply">
	              	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>CreateObjectionCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
						</bpel:invoke>

                        
                    
                        
                    
                        </bpel:sequence>
                        <bpel:sequence name="ValidateObjectionCase"><bpel:assign validate="no" name="PrepareInvokeValidateObjectionCase">
                            <bpel:copy>
                                <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="validateObjectionCaseRequest"></bpel:to>
                            </bpel:copy>
                            
                            <bpel:copy>
                                <bpel:from variable="ticket"></bpel:from>
                                <bpel:to part="parameters" variable="validateObjectionCaseRequest"/>
                            </bpel:copy>
                            
                        </bpel:assign>
                        <bpel:invoke name="InvokeValidateObjectionCase" partnerLink="HandleCasePL" operation="validateObjectionCase" portType="ns:HandleCase" inputVariable="validateObjectionCaseRequest" outputVariable="validateObjectionCaseReply">
	              	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>ValidateObjectionCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
						</bpel:invoke>
                        
                    
                        </bpel:sequence>
                        <bpel:if name="IfNewObjection">
						<bpel:condition caseType="New"/>
                        <bpel:sequence name="CreateObjectionTask"><bpel:assign validate="no" name="PrepareCreateObjectionTask">
                            
                            
    
                            <bpel:copy>
                                <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="createObjectionTaskRequest"></bpel:to>
                            </bpel:copy>
                            
                            <bpel:copy>
                                <bpel:from variable="ticket"></bpel:from>
                                <bpel:to part="parameters" variable="createObjectionTaskRequest"/>
                            </bpel:copy>
                            
                        </bpel:assign>
				<bpel:invoke name="InvokeCreateObjectionTask" partnerLink="HandleCasePL" operation="createObjectionTask" portType="ns:HandleCase" inputVariable="createObjectionTaskRequest" outputVariable="createObjectionTaskReply">
	              	<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>CreateObjectionTask</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
				</bpel:invoke>

                        
                    
                        </bpel:sequence>
                        <bpel:else>
                            <bpel:sequence name="StopObjectionCase">
                        
    
    
    

                    
                        <bpel:assign validate="no" name="PrepareInvokeStopObjectionCase">
                            <bpel:copy>
                                <bpel:from>
                                    <bpel:literal>impl:idObj</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="stopCaseRequest"></bpel:to>
                            </bpel:copy>
                            
                            <bpel:copy>
                                <bpel:from variable="ticket"></bpel:from>
                                <bpel:to part="parameters" variable="stopCaseRequest"/>
                            </bpel:copy>
                            
                        </bpel:assign>
                        
                        <bpel:invoke name="InvokeStopObjectionCase" partnerLink="HandleCasePL" operation="stopCase" portType="ns:HandleCase" inputVariable="stopCaseRequest" outputVariable="stopCaseReply">
						<bpel:catch faultName="ns:WsException" faultVariable="exception" faultMessageType="ns:WsException">
                    	<bpel:sequence name="CreateExceptionTask">
                                    
                        	<bpel:assign validate="no" name="PrepareExceptionTask">
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>1</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                    <bpel:copy>
                                        <bpel:from>
                                            <bpel:literal>StopObjectionCase</bpel:literal>
                                        </bpel:from>
                                        <bpel:to part="fault" variable="exception"/>
                                    </bpel:copy>
                                        
                                <bpel:copy>
    	                            <bpel:from>
                                    <bpel:literal>impl:id</bpel:literal>
                                    </bpel:from>
                                    <bpel:to part="parameters" variable="createExceptionTaskRequest"></bpel:to>
                            	</bpel:copy>
                         	</bpel:assign>
                            
                            <bpel:invoke name="InvokeCreateExceptionTask" partnerLink="HandleCasePL" operation="createExceptionTask" portType="ns:HandleCase" inputVariable="createExceptionTaskRequest" outputVariable="createExceptionTaskReply"></bpel:invoke>
                            <bpel:throw name="StopProcess" faultVariable="exception" faultName="tns:ServiceFault"></bpel:throw>
                        </bpel:sequence>
                        </bpel:catch>  
						</bpel:invoke>

						</bpel:sequence>
                        </bpel:else>
                    
                        </bpel:if>
                        
                        
                    
                    </bpel:sequence>
                    <bpel:if name="IfNotReinjectedObjectionCase">
                        <bpel:condition noreinjection="true"/>
                        <bpel:sequence name="ReplyHandleObjectionResponse">
                            <bpel:assign validate="no" name="PrepareReplyHandleObjection"><bpel:copy><bpel:from>
                                    <bpel:literal>tns:result</bpel:literal>
                                </bpel:from>
                                <bpel:to part="parameters" variable="handleObjectionOutput"></bpel:to>
                            
                            </bpel:copy>
                            <bpel:copy><bpel:from variable="ticket"></bpel:from>
                            <bpel:to part="parameters" variable="handleObjectionOutput"/>
                        
                            </bpel:copy>
                        
                            </bpel:assign><bpel:reply name="ReplyHandleObjection" partnerLink="client" operation="handleObjection" portType="tns:HandleCaseProcess" variable="handleObjectionOutput"></bpel:reply>
                    
                        
                        </bpel:sequence>
                    </bpel:if>
                    
                    </bpel:sequence>
            </bpel:elseif></bpel:if>
        <bpel:if name="Reinjected">
            <bpel:condition noreinjection="false" />
            <bpel:sequence name="ReplyReinjectCase">
                
                
                
                <bpel:assign validate="no" name="PrepareReplyReinjectCase">
                    
                    
                    <bpel:copy>
                        <bpel:from><bpel:literal>tns:result</bpel:literal></bpel:from>
                        <bpel:to variable="reinjectCaseOutput" part="parameters"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from variable="valueOk"></bpel:from>
                        <bpel:to part="parameters" variable="reinjectCaseOutput"/>
                    </bpel:copy>
                    
                </bpel:assign>
                <bpel:reply name="ReplyReinjectCase" partnerLink="client" operation="reinjectCase" portType="tns:HandleCaseProcess" variable="reinjectCaseOutput"></bpel:reply>
                
            </bpel:sequence></bpel:if>
    </bpel:sequence>
</bpel:process>

